<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Simon Bonner" />

<meta name="date" content="2016-12-27" />

<title>Linking Wildbook and marked via RWildbook</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Linking Wildbook and marked via RWildbook</h1>
<h4 class="author"><em>Simon Bonner</em></h4>
<h4 class="date"><em>2016-12-27</em></h4>



<p>Here we show how data retrieved from a Wildbook database can be formatted and analysed using the marked package by Jeff Laake (also the creator of the RMark package). In particular, we fit a simple Cormack-Jolly-Seber model to data retrieved from whaleshark.org.</p>
<p>First we load the RWildbook and marked package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Load other packages
<span class="kw">library</span>(RWildbook)</code></pre></div>
<pre><code>## Loading required package: jsonlite</code></pre>
<pre><code>## Loading required package: data.table</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(marked)</code></pre></div>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## This is marked 1.1.11</code></pre>
<p>Next we use the searchWB() function from RWildbook to retrieve data for the first 99 whale sharks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Extract data for individual A-001 through A-099
vignette_2_data &lt;-<span class="st"> </span><span class="kw">searchWB</span>(<span class="dt">username=</span><span class="st">&quot;username&quot;</span>,
                            <span class="dt">password=</span><span class="st">&quot;password&quot;</span>,
                            <span class="dt">baseURL =</span><span class="st">&quot;whaleshark.org&quot;</span>,
                            <span class="dt">object=</span><span class="st">&quot;Encounter&quot;</span>,
                            <span class="dt">individualID=</span><span class="kw">paste0</span>(<span class="st">&quot;A-0&quot;</span>,<span class="kw">rep</span>(<span class="dv">0</span>:<span class="dv">9</span>,<span class="kw">rep</span>(<span class="dv">10</span>,<span class="dv">10</span>)),<span class="kw">rep</span>(<span class="dv">0</span>:<span class="dv">9</span>,<span class="dv">10</span>))[-<span class="dv">1</span>])</code></pre></div>
<p>This results in the following data frame (not the that the time of encounter has been modified to maintain data privacy):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;vignette_2_data&quot;</span>,<span class="dt">package=</span><span class="st">&quot;RWildbook&quot;</span>)
<span class="kw">head</span>(vignette_2_data)[,<span class="kw">c</span>(<span class="st">&quot;individualID&quot;</span>,<span class="st">&quot;location&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;month&quot;</span>,<span class="st">&quot;day&quot;</span>)]</code></pre></div>
<pre><code>##   individualID                                        location year month
## 1        A-098                Ningaloo Marine Park (Coral Bay) 2003    11
## 2        A-052 Exmouth Gulf, Back of Reef in Bundegi Sanctuary 2005    11
## 3        A-013                                  North Ningaloo 2014    11
## 4        A-003                      north ningaloo marine park 2011     5
## 5        A-079                                  North Ningaloo 2013     6
## 6        A-063                  coral bay ningaloo marine park 2011     7
##   day
## 1  10
## 2  13
## 3  16
## 4  13
## 5   6
## 6   7</code></pre>
<p>Now we can create capture histories by defining the start and end times of the capture occasions. For illustration, we assume that the capture occasions cover January, February, and March of each year from 1998 through 2016.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> ## Define start and end dates of capture occasions
 start.dates1 &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="dv">1998</span>:<span class="dv">2016</span>,<span class="st">&quot;-01-01&quot;</span>) <span class="co">#Define the start.date value</span>
 end.dates1 &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="dv">1998</span>:<span class="dv">2016</span>,<span class="st">&quot;-04-01&quot;</span>) <span class="co">#Define the end.date value</span>

 ## Format data for use in marked
 markedData1 &lt;-<span class="st"> </span><span class="kw">markedData</span>(<span class="dt">data =</span> vignette_2_data,
                              <span class="dt">varname_of_capturetime =</span> <span class="st">&quot;dateInMilliseconds&quot;</span>,
                              <span class="dt">varlist =</span> <span class="kw">c</span>(<span class="st">&quot;individualID&quot;</span>),
                              <span class="dt">start.dates =</span> start.dates1,
                              <span class="dt">end.dates =</span> <span class="ot">NULL</span>,
                              <span class="dt">date_format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>,
                              <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>)</code></pre></div>
<pre><code>## Note: Removing 25 individuals with no observed captures.</code></pre>
<p>We can now fit the Cormack-Jolly-Seber model using the functions in mark to first format the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> ## Fit simple CJS model in marked
 markedData1.proc=<span class="kw">process.data</span>(markedData1,<span class="dt">model=</span><span class="st">&quot;cjs&quot;</span>,<span class="dt">begin.time=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## 74 capture histories collapsed into 74</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> markedData1.ddl=<span class="kw">make.design.data</span>(markedData1.proc)
 markedData1.cjs=<span class="kw">crm</span>(markedData1.proc,markedData1.ddl,<span class="dt">model.parameters=</span><span class="kw">list</span>(<span class="dt">Phi=</span><span class="kw">list</span>(<span class="dt">formula=</span>~time),<span class="dt">p=</span><span class="kw">list</span>(<span class="dt">formula=</span>~time)))</code></pre></div>
<pre><code>## Fitting model</code></pre>
<pre><code>## Computing initial parameter estimates</code></pre>
<pre><code>## Accumulating capture histories based on design. This can take awhile...</code></pre>
<pre><code>## 74 capture histories collapsed into 51</code></pre>
<pre><code>## Starting optimization for 36 parameters...</code></pre>
<pre><code>## 
 Number of evaluations:  100  -2lnl: 661.4810565
 Number of evaluations:  200  -2lnl: 657.6593186
 Number of evaluations:  300  -2lnl:  654.738069
 Number of evaluations:  400  -2lnl: 654.2391281
 Number of evaluations:  500  -2lnl:  653.862695
 Number of evaluations:  600  -2lnl: 653.4780271
 Number of evaluations:  700  -2lnl: 653.3505049
 Number of evaluations:  800  -2lnl:  653.126154
 Number of evaluations:  900  -2lnl:  652.916061
 Number of evaluations:  1000  -2lnl:   652.85315
 Number of evaluations:  1100  -2lnl: 652.7996062
 Number of evaluations:  1200  -2lnl: 652.7025896
 Number of evaluations:  1300  -2lnl:  652.668327
 Number of evaluations:  1400  -2lnl: 652.5942031
 Number of evaluations:  1500  -2lnl: 652.5536496
 Number of evaluations:  1600  -2lnl: 652.5443796
 Number of evaluations:  1700  -2lnl: 652.5235439
 Number of evaluations:  1800  -2lnl: 652.5164447
 Number of evaluations:  1900  -2lnl: 652.5126744
 Number of evaluations:  2000  -2lnl: 652.5075915
 Number of evaluations:  2100  -2lnl: 652.5068583
 Number of evaluations:  2200  -2lnl: 652.5059795
 Number of evaluations:  2300  -2lnl:  652.502895
 Number of evaluations:  2400  -2lnl: 652.5016548
 Number of evaluations:  2500  -2lnl: 652.4991583
 Number of evaluations:  2600  -2lnl:  652.498644
 Number of evaluations:  2700  -2lnl: 652.4983563
 Number of evaluations:  2800  -2lnl: 652.4975948
 Number of evaluations:  2900  -2lnl: 652.4968093
 Number of evaluations:  3000  -2lnl: 652.4957483
 Number of evaluations:  3100  -2lnl:   652.49337
 Number of evaluations:  3200  -2lnl: 652.4913842
 Number of evaluations:  3300  -2lnl: 652.4884967
 Number of evaluations:  3400  -2lnl: 652.4840881
 Number of evaluations:  3500  -2lnl: 652.4834014
 Number of evaluations:  3600  -2lnl: 652.4825869
 Number of evaluations:  3700  -2lnl: 652.4822268
 Number of evaluations:  3800  -2lnl: 652.4820066
 Number of evaluations:  3900  -2lnl: 652.4819051
 Number of evaluations:  4000  -2lnl: 652.4818957
 Number of evaluations:  4100  -2lnl: 652.4818741
 Number of evaluations:  4200  -2lnl: 652.4818424
 Number of evaluations:  4300  -2lnl: 652.5423162
 Number of evaluations:  4400  -2lnl:  652.483646
 Number of evaluations:  4500  -2lnl: 652.4878773
 Number of evaluations:  4600  -2lnl: 652.5380764
 Number of evaluations:  4700  -2lnl: 652.4848939
 Number of evaluations:  4800  -2lnl: 652.4858153
 Number of evaluations:  4900  -2lnl: 652.4839405
 Number of evaluations:  5000  -2lnl: 652.4822173
 Number of evaluations:  5100  -2lnl: 652.5428698
 Number of evaluations:  5200  -2lnl: 652.4858546
 Number of evaluations:  5300  -2lnl: 652.5422815
 Number of evaluations:  5400  -2lnl: 652.4821965
 Number of evaluations:  5500  -2lnl: 652.4819787
 Number of evaluations:  5600  -2lnl:  652.482424
 Number of evaluations:  5700  -2lnl:  652.513276
 Number of evaluations:  5800  -2lnl: 652.4872118
 Number of evaluations:  5900  -2lnl: 652.5201534
 Number of evaluations:  6000  -2lnl: 652.4848467
 Number of evaluations:  6100  -2lnl: 652.4901234
 Number of evaluations:  6200  -2lnl: 652.4827419
 Number of evaluations:  6300  -2lnl: 652.4845256
 Number of evaluations:  6400  -2lnl: 652.5361715
 Number of evaluations:  6500  -2lnl: 652.4900906
 Number of evaluations:  6600  -2lnl: 652.4857628
 Number of evaluations:  6700  -2lnl: 652.4918908
 Number of evaluations:  6800  -2lnl: 652.4857677
 Number of evaluations:  6900  -2lnl: 652.5087466
 Number of evaluations:  7000  -2lnl:  652.481842
 Number of evaluations:  7100  -2lnl: 652.5200702
 Number of evaluations:  7200  -2lnl:  652.481838
 Number of evaluations:  7300  -2lnl: 652.5200059
 Number of evaluations:  7400  -2lnl: 652.4856887
 Number of evaluations:  7500  -2lnl: 652.5075832
 Number of evaluations:  7600  -2lnl: 652.4864769
 Number of evaluations:  7700  -2lnl: 652.5031411
 Number of evaluations:  7800  -2lnl:  652.536059
 Number of evaluations:  7900  -2lnl: 652.4926024
 Number of evaluations:  8000  -2lnl: 652.4823632
 Number of evaluations:  8100  -2lnl: 652.4878746
 Number of evaluations:  8200  -2lnl: 652.4823879
 Number of evaluations:  8300  -2lnl: 652.4931355
 Number of evaluations:  8400  -2lnl: 652.4829153
 Number of evaluations:  8500  -2lnl: 652.4982733
 Number of evaluations:  8600  -2lnl: 652.4828685
 Number of evaluations:  8700  -2lnl:  652.489097
 Number of evaluations:  8800  -2lnl: 652.4856823
 Number of evaluations:  8900  -2lnl: 652.4906436
 Number of evaluations:  9000  -2lnl: 652.4826364
 Number of evaluations:  9100  -2lnl: 652.4847457
 Number of evaluations:  9200  -2lnl: 652.4822262
 Number of evaluations:  9300  -2lnl: 652.4826786
 Number of evaluations:  9400  -2lnl: 652.4818565
 Number of evaluations:  9500  -2lnl: 652.4821469
 Number of evaluations:  9600  -2lnl: 652.4818359
 Number of evaluations:  9700  -2lnl: 652.4818359
 Number of evaluations:  9800  -2lnl: 652.4818359
## Elapsed time in minutes:  0.0497</code></pre>
<p>and plot the estimated capture and survival probabilities:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot parameter estimates
<span class="kw">plot</span>(<span class="dv">1998</span>:<span class="dv">2015</span>,markedData1.cjs$results$reals$Phi$estimate,
        <span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,
        <span class="dt">main=</span><span class="st">&quot;Estimated Capture and Survival Probabilities&quot;</span>,
        <span class="dt">xlab=</span><span class="st">&quot;Occasion&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimate&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">points</span>(<span class="dv">1999</span>:<span class="dv">2016</span>,markedData1.cjs$results$reals$p$estimate,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Survival&quot;</span>,<span class="st">&quot;Capture&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
